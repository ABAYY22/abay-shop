<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Abay Studio | All-in-One</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;700;900&display=swap');
        body { background: #000; color: #fff; font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        .glass { background: rgba(255, 255, 255, 0.03); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); }
        .admin-only { display: none; }
        .is-admin .admin-only { display: block; }
    </style>
</head>
<body class="bg-black text-white antialiased">

    <nav class="fixed w-full z-50 glass px-6 py-4 flex justify-between items-center">
        <h1 class="text-xl font-black tracking-tighter uppercase">Abay Studio</h1>
        <div class="flex gap-5 text-sm font-bold uppercase">
            <a href="#portfolio" class="hover:text-blue-500">Portfolio</a>
            <a href="#shop" class="hover:text-blue-500">Shop</a>
            <button onclick="showSales()" class="admin-only text-yellow-500">Sales</button>
        </div>
    </nav>

    <section id="portfolio" class="min-h-screen flex flex-col justify-center items-center px-6 text-center">
        <div id="hero-display">
            <h1 class="text-7xl md:text-9xl font-black mb-4">CREATIVE</h1>
            <p class="text-gray-500 text-lg">Loading content...</p>
        </div>
        <button onclick="editHero()" class="admin-only mt-10 bg-blue-600 px-6 py-2 rounded-full text-xs font-bold uppercase">Edit Hero</button>
    </section>

    <section id="shop" class="py-20 px-6 max-w-6xl mx-auto">
        <div class="flex justify-between items-end mb-12">
            <h2 class="text-4xl font-black uppercase">The Shop</h2>
            <button onclick="addProduct()" class="admin-only bg-green-600 px-4 py-2 rounded text-xs font-bold">ADD ITEM</button>
        </div>
        <div id="product-list" class="grid grid-cols-1 md:grid-cols-3 gap-6">
            </div>
    </section>

    <div id="pay-modal" class="fixed inset-0 z-[100] hidden bg-black/95 flex items-center justify-center p-6">
        <div class="glass max-w-md w-full p-8 rounded-3xl relative">
            <button onclick="closeModal()" class="absolute top-4 right-4 text-gray-500"><i class="fas fa-times"></i></button>
            <h3 id="m-name" class="text-2xl font-black mb-1"></h3>
            <p id="m-price" class="text-blue-500 font-bold mb-8"></p>
            
            <div class="space-y-4 mb-8">
                <div class="p-4 bg-white/5 rounded-xl flex justify-between items-center border border-white/10">
                    <div><p class="text-[10px] opacity-50 uppercase">DANA/GOPAY</p><p class="font-bold">087893344461</p></div>
                    <button onclick="copy('087893344461')" class="bg-blue-600 px-3 py-1 rounded text-xs">Copy</button>
                </div>
                <div class="bg-white p-4 rounded-xl flex flex-col items-center">
                    <p class="text-black text-[10px] font-bold mb-2 uppercase">Scan QRIS</p>
                    <img src="https://files.catbox.moe/nzkt5h.jpg" class="w-32 h-32">
                </div>
            </div>
            <button onclick="confirmPayment()" class="w-full bg-blue-600 py-4 rounded-xl font-bold uppercase hover:bg-blue-500">I Have Paid</button>
        </div>
    </div>

    <footer class="py-20 text-center opacity-20">
        <p onclick="adminLogin()" class="text-[10px] tracking-widest cursor-default">ADMIN SYSTEM ACCESS</p>
    </footer>

    <script>
        // MASUKKAN LINK DATABASE ANDA DI SINI (Pastikan akhiri dengan garis miring /)
        const dbUrl = "https://toko-49a45-default-rtdb.firebaseio.com/"; 
        
        let currentItem = {};

        // Ambil Data
        async function loadData() {
            // Load Hero
            const hRes = await fetch(dbUrl + "hero.json");
            const h = await hRes.json();
            if(h) document.getElementById('hero-display').innerHTML = `<h1 class="text-7xl md:text-9xl font-black mb-4 uppercase tracking-tighter">${h.title}</h1><p class="text-gray-500 text-lg">${h.desc}</p>`;

            // Load Products
            const pRes = await fetch(dbUrl + "products.json");
            const p = await pRes.json();
            const list = document.getElementById('product-list');
            list.innerHTML = '';
            for(let id in p) {
                list.innerHTML += `
                <div class="glass p-5 rounded-2xl">
                    <img src="${p[id].img}" class="h-48 w-full object-cover rounded-xl mb-4">
                    <h3 class="text-xl font-bold uppercase">${p[id].name}</h3>
                    <p class="text-sm text-gray-500 mb-6">${p[id].desc}</p>
                    <div class="flex justify-between items-center">
                        <span class="text-xl font-black">Rp ${parseInt(p[id].price).toLocaleString()}</span>
                        <div class="flex gap-2">
                            <button onclick="startPay('${p[id].name}', ${p[id].price})" class="bg-white text-black px-4 py-2 rounded font-bold text-xs uppercase">Buy</button>
                            <button onclick="delProduct('${id}')" class="admin-only text-red-500 px-2"><i class="fas fa-trash"></i></button>
                        </div>
                    </div>
                </div>`;
            }
        }

        // Pembayaran & Sales
        function startPay(n, p) {
            currentItem = { n, p };
            document.getElementById('m-name').innerText = n;
            document.getElementById('m-price').innerText = "Rp " + p.toLocaleString();
            document.getElementById('pay-modal').classList.remove('hidden');
        }

        async function confirmPayment() {
            const time = new Date().toLocaleString();
            // Simpan Sales
            await fetch(dbUrl + "sales.json", {
                method: 'POST',
                body: JSON.stringify({ item: currentItem.n, price: currentItem.p, date: time })
            });

            // WA Redirect
            const msg = `Halo Abay! Konfirmasi Bayar:\nItem: ${currentItem.n}\nHarga: Rp ${currentItem.p.toLocaleString()}\nJam: ${time}`;
            window.open(`https://wa.me/6281234567890?text=${encodeURIComponent(msg)}`);
            closeModal();
        }

        // Admin Controls
        async function editHero() {
            const { value: v } = await Swal.fire({
                title: 'Edit Hero',
                html: '<input id="t" class="swal2-input" placeholder="Title"><input id="d" class="swal2-input" placeholder="Desc">',
                preConfirm: () => [document.getElementById('t').value, document.getElementById('d').value]
            });
            if(v) {
                await fetch(dbUrl + "hero.json", { method: 'PUT', body: JSON.stringify({ title: v[0], desc: v[1] }) });
                loadData();
            }
        }

        async function addProduct() {
            const { value: v } = await Swal.fire({
                title: 'Add Product',
                html: '<input id="n" class="swal2-input" placeholder="Name"><input id="p" class="swal2-input" type="number" placeholder="Price"><input id="i" class="swal2-input" placeholder="Image URL"><input id="d" class="swal2-input" placeholder="Desc">',
                preConfirm: () => [document.getElementById('n').value, document.getElementById('p').value, document.getElementById('i').value, document.getElementById('d').value]
            });
            if(v) {
                await fetch(dbUrl + "products.json", { method: 'POST', body: JSON.stringify({ name: v[0], price: v[1], img: v[2], desc: v[3] }) });
                loadData();
            }
        }

        async function delProduct(id) {
            if(confirm('Hapus?')) { await fetch(`${dbUrl}products/${id}.json`, { method: 'DELETE' }); loadData(); }
        }

        async function showSales() {
            const r = await fetch(dbUrl + "sales.json");
            const s = await r.json();
            let html = '<div class="text-left text-xs">';
            let total = 0;
            for(let id in s) {
                total += parseInt(s[id].price);
                html += `<div class="mb-2 border-b border-white/10 pb-1"><b>${s[id].item}</b><br><span class="opacity-50">${s[id].date}</span> - Rp${s[id].price.toLocaleString()}</div>`;
            }
            html += `</div><div class="mt-4 text-xl font-bold text-green-500">Total: Rp ${total.toLocaleString()}</div>`;
            Swal.fire({ title: 'Sales Log', html, background: '#111', color: '#fff' });
        }

        function adminLogin() {
            Swal.fire({ title: 'Pass?', input: 'password' }).then(res => {
                if(res.value === 'abay123') document.body.classList.add('is-admin');
            });
        }

        function closeModal() { document.getElementById('pay-modal').classList.add('hidden'); }
        function copy(t) { navigator.clipboard.writeText(t); alert('Copied!'); }

        loadData();
    </script>
</body>
</html>
